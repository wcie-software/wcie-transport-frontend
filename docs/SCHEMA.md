# Data Schema

This document provides an overview of the Firestore collections and the Zod schemas used for data validation. To ensure accuracy, please refer to the linked model files for the most up-to-date schema definitions.

## Base Document

All data models inherit from the `BaseDocument` schema, which provides a standard way to handle Firestore document IDs.

- **Source**: [base.ts](../src/app/models/base.ts)

---

## Firestore Collections

### `requests`
Stores transportation requests submitted by members via Fillout.
- **Model**: [request.ts](../src/app/models/request.ts)
- **Overview**: Captures passenger details, pickup location (coordinates), service number, and request status.

### `drivers`
Stores profiles for registered drivers.
- **Model**: [driver.ts](../src/app/models/driver.ts)
- **Overview**: Contains contact information, license class, and current/last known location.

### `vehicles`
Stores details about the fleet of vehicles used for transport.
- **Model**: [vehicle.ts](../src/app/models/vehicle.ts)
- **Overview**: Tracks vehicle capacity, plate numbers, and maintenance/fuel status.

### `schedules`
Manages the weekly assignment of drivers to specific service shifts.
- **Model**: [schedule.ts](../src/app/models/schedule.ts)
- **Overview**: Maps driver IDs to service numbers for a given Sunday timestamp.

### `assigned-routes` (Assignments)
Stores the optimized routes generated by the routing microservice.
- **Model**: [fleet_route.ts](../src/app/models/fleet_route.ts)
- **Overview**: Contains the sequences of pickup/drop-off points assigned to each driver and vehicle for a specific week.

### `users` & `admins`
Collection for general user profiles and dedicated admin accounts.
- **Models**: [user.ts](../src/app/models/user.ts), [admin.ts](../src/app/models/admin.ts)

---

## Validation Highlights

We leverage **Zod** across the application to ensure:
- **Runtime Safety**: Data is validated immediately upon being fetched from Firestore.
- **Transformed Data**: Automatic coercion of types (e.g., strings to numbers) and normalization of inputs.
- **Complex Rules**: Enforcement of business logic (e.g., ensuring seat availability) directly at the schema level.
